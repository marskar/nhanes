<pre><code>library(dplyr)

## 
## Attaching package: &#39;dplyr&#39;

## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag

## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union

## read in data processed using sas ####
adult &lt;- readr::read_csv(here::here(&quot;dat/adult.csv&quot;))

## Parsed with column specification:
## cols(
##   .default = col_character(),
##   DMPSTAT = col_integer(),
##   DMARETHN = col_integer(),
##   DMARACER = col_integer(),
##   DMAETHNR = col_integer(),
##   HSSEX = col_integer(),
##   HSAGEIR = col_integer(),
##   HSAGEU = col_integer(),
##   DMPMETRO = col_integer(),
##   DMPCREGN = col_integer(),
##   SDPPHASE = col_integer(),
##   SDPPSU6 = col_integer(),
##   SDPPSU1 = col_integer(),
##   MXPLANG = col_integer(),
##   MXPSESSR = col_integer(),
##   MXPTIDW = col_integer(),
##   HXPSESSR = col_integer(),
##   HXPTIDW = col_integer(),
##   HFVERS = col_integer(),
##   HFINTVR = col_integer(),
##   HFLANG = col_integer()
##   # ... with 565 more columns
## )

## See spec(...) for full column specifications.

mort &lt;- readr::read_rds(here::here(&quot;dat/1-clean-mort.rds&quot;))
exam &lt;- readr::read_csv(here::here(&quot;dat/exam.csv&quot;))

## Parsed with column specification:
## cols(
##   .default = col_integer(),
##   DMPPIR = col_character(),
##   SDPPSU2 = col_character(),
##   SDPSTRA2 = col_character(),
##   WTPFQX6 = col_character(),
##   WTPFEX6 = col_character(),
##   WTPFHX6 = col_character(),
##   WTPFALG6 = col_character(),
##   WTPFCNS6 = col_character(),
##   WTPFSD6 = col_character(),
##   WTPFMD6 = col_character(),
##   WTPFHSD6 = col_character(),
##   WTPFHMD6 = col_character(),
##   WTPFQX1 = col_character(),
##   WTPFEX1 = col_character(),
##   WTPFHX1 = col_character(),
##   WTPFALG1 = col_character(),
##   WTPFCNS1 = col_character(),
##   WTPFSD1 = col_character(),
##   WTPFMD1 = col_character(),
##   WTPFHSD1 = col_character()
##   # ... with 648 more columns
## )
## See spec(...) for full column specifications.

lab &lt;- readr::read_csv(here::here(&quot;dat/lab.csv&quot;))

## Parsed with column specification:
## cols(
##   .default = col_character(),
##   SEQN = col_integer(),
##   DMPFSEQ = col_integer(),
##   DMPSTAT = col_integer(),
##   DMARETHN = col_integer(),
##   DMARACER = col_integer(),
##   DMAETHNR = col_integer(),
##   HSSEX = col_integer(),
##   HSAGEIR = col_integer(),
##   HSAGEU = col_integer(),
##   HSAITMOR = col_integer(),
##   HSFSIZER = col_integer(),
##   HSHSIZER = col_integer(),
##   DMPCNTYR = col_integer(),
##   DMPFIPSR = col_integer(),
##   DMPMETRO = col_integer(),
##   DMPCREGN = col_integer(),
##   SDPPHASE = col_integer(),
##   SDPPSU6 = col_integer(),
##   SDPSTRA6 = col_integer(),
##   SDPPSU1 = col_integer()
##   # ... with 190 more columns
## )
## See spec(...) for full column specifications.

## change SEQN to numeric in all datasets read in from csv
adult$SEQN &lt;- as.numeric(adult$SEQN)
exam$SEQN &lt;- as.numeric(exam$SEQN)
lab$SEQN &lt;- as.numeric(lab$SEQN)

#levels(dat$UCOD_LEADING)

## Join all datasets, remove baseline cancer cases
## Create a cancer death variable
## Convert all character variables to numeric
## Select only columns with less than 10% NAs
## write out an RDS file
left_join(x = mort, y = adult, by = &quot;SEQN&quot;) %&gt;%
left_join(x = ., y = exam, by = &quot;SEQN&quot;) %&gt;%
left_join(x = ., y = lab, by = &quot;SEQN&quot;) %&gt;%
filter(HAC1N==2 &amp;
       HAC1O==2 &amp;
       !is.na(SDPPSU6) &amp;
       !is.na(SDPSTRA6) &amp;
       !is.na(WTPFQX6)) %&gt;%
mutate(canc_mort =
       if_else(UCOD_LEADING ==
               &#39;Malignant neoplasms (C00-C97)&#39;,
               true = 1, false = 0)) %&gt;%
mutate_if(.predicate = is.character,
          .funs = as.numeric) %&gt;%
select(which(colMeans(is.na(.))==0)) %&gt;%
readr::write_rds(here::here(&quot;dat/2-join-complete-cases.rds&quot;))

## Warning in evalq(as.numeric(HAJ12), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(HAX18A), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(HAX18B), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(HAX18C), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(HAZA1CC), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(DEPSTLC1), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(DEPSTLC2), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(DEPSTLC3), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(DEPSTLC4), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(DEPSTLC5), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(DEPSTLC6), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(SPPTIME), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(PHPSNTI), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(PHPDRTI), &lt;environment&gt;): NAs introduced by
## coercion

## Warning in evalq(as.numeric(PHPBEST), &lt;environment&gt;): NAs introduced by
## coercion

#warnings()
## 15 variables (HAJ12, HAX18A, HAX18B, HAX18C, HAZA1CC, DEPSTLC1, DEPSTLC2, DEPSTLC3, DEPSTLC4, DEPSTLC5, DEPSTLC6, SPPTIME, PHPSNTI, PHPDRTI, PHPBEST) could not be converted to numeric, and instead were coerced to NAs
## 3 time variables coerced into NA (PHPSNTI, PHPDRTI, PHPBEST)
## Consider converting these 3 to a different class later</code></pre>
